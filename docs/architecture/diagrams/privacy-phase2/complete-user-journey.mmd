sequenceDiagram
    participant Alice
    participant Bob
    participant Chain
    participant Tree as Merkle Tree
    participant Observer

    Note over Chain: Block 1000
    Alice->>Chain: Shield 100ulight
    Chain->>Tree: Add C1 @ index 42
    Tree-->>Chain: Root: R1
    Observer->>Observer: ğŸ‘€ Alice shielded<br/>SOME amount

    Note over Chain: Block 1005
    Alice->>Chain: Private Transfer<br/>(ZK proof Ï€1)
    Chain->>Chain: Verify proof Ï€1 âœ“
    Chain->>Tree: Mark N1 used
    Chain->>Tree: Add C2 @ index 100
    Chain->>Tree: Add C3 @ index 101
    Tree-->>Chain: Root: R2
    Observer->>Observer: ğŸ‘€ SOMEONE did transfer<br/>â“ Who? How much?<br/>â“ Can't tell!

    Note over Chain: Block 1010
    Bob->>Chain: Scan blocks 1000-1010
    Chain-->>Bob: Encrypted notes
    Bob->>Bob: Decrypt note@100<br/>60ulight is mine! ğŸ‰

    Note over Chain: Block 1015
    Bob->>Chain: Unshield 60ulight<br/>(ZK proof Ï€2)
    Chain->>Chain: Verify proof Ï€2 âœ“
    Chain->>Tree: Mark N2 used
    Chain->>Bob: Mint 60ulight
    Observer->>Observer: ğŸ‘€ Bob unshielded 60

    rect rgb(255, 220, 220)
        Note over Observer: Observer's Limited View:
        Note over Observer: âœ“ Alice shielded (amount hidden)
        Note over Observer: âœ“ Someone transferred (all hidden)
        Note over Observer: âœ“ Bob unshielded 60
        Note over Observer: âœ— CANNOT link Alice to Bob
        Note over Observer: âœ— Could be ANYONE with notes
        Note over Observer: Anonymity set: 100+ notes
    end

    rect rgb(220, 255, 220)
        Note over Alice,Bob: Privacy Achieved:
        Note over Alice,Bob: â€¢ Transaction graph hidden
        Note over Alice,Bob: â€¢ Amounts hidden (except entry/exit)
        Note over Alice,Bob: â€¢ Sender/recipient unlinkable
        Note over Alice,Bob: â€¢ Large anonymity set
    end
